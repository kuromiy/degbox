# 作者機能 概要

## 目的

コンテンツ制作者（作者）を管理するための機能群。作者の登録、編集、検索、詳細表示、およびビデオ登録時の作者選択・新規登録を提供する。

## 画面一覧

### 1. 作者検索画面
- **目的**: 作者の一覧表示と検索
- **URL**: `/author/search`
- **詳細**: [作者検索画面.md](./作者検索画面.md)

### 2. 作者詳細画面
- **目的**: 作者情報の表示と紐づいた動画一覧の表示
- **URL**: `/author/:authorId`
- **詳細**: [作者詳細画面.md](./作者詳細画面.md)

### 3. 作者登録画面
- **目的**: 新規作者の登録
- **URL**: `/author/create`
- **詳細**: [作者登録画面.md](./作者登録画面.md)

### 4. 作者編集画面
- **目的**: 既存作者情報の編集
- **URL**: `/author/:authorId/edit`
- **詳細**: [作者編集画面.md](./作者編集画面.md)

### 5. 作者選択モーダル
- **目的**: ビデオ登録時の作者選択・新規作者登録
- **表示元**: ビデオ登録画面内
- **詳細**: [作者選択モーダル.md](./作者選択モーダル.md)

## データモデル

### Author型
```typescript
export type Author = {
  id: string;
  name: string;
  urls: Record<string, string>;
};
```

**定義場所**: `features/author/author.model.ts`

## データベーススキーマ

### Authorsテーブル
```sql
CREATE TABLE Authors (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  urls TEXT -- JSON形式で保存: '{"twitter": "https://...", "youtube": "https://..."}'
);
```

### Videos-Authorsテーブル（中間テーブル）
```sql
CREATE TABLE Videos_Authors (
  videoId TEXT NOT NULL,
  authorId TEXT NOT NULL,
  PRIMARY KEY (videoId, authorId),
  FOREIGN KEY (videoId) REFERENCES Videos(id) ON DELETE CASCADE,
  FOREIGN KEY (authorId) REFERENCES Authors(id) ON DELETE CASCADE
);
```

**注**: `urls`フィールドはJSON文字列として保存し、アプリケーション層でパース・シリアライズを行う。

## URLsフィールドの使用例

```typescript
{
  "twitter": "https://twitter.com/username",
  "youtube": "https://youtube.com/@channel",
  "official": "https://example.com",
  "pixiv": "https://pixiv.net/users/12345"
}
```

## 使用技術

- **ルーティング**: React Router DOM 7.9.1
- **状態管理**: React Hooks（useState, useEffect）
- **モーダル**: React Modal または独自実装
- **SSR**: Hono + react-hydra-builder

## 非機能要件

### パフォーマンス
- **初期表示**: 1秒以内に画面を表示
- **検索レスポンス**: 500ms以内に検索結果を返す
- **ページネーション**: スムーズなページ遷移

### セキュリティ
- **入力検証**: クライアント側およびサーバー側でバリデーション
- **SQLインジェクション対策**: プリペアドステートメント使用

### ユーザビリティ
- **レスポンシブ**: ウィンドウサイズに応じた適切な表示
- **エラーハンドリング**: わかりやすいエラーメッセージ表示
- **ローディング表示**: データ取得中のローディングインジケーター
- **アクセシビリティ**: キーボード操作対応、スクリーンリーダー対応

### データ整合性
- **参照整合性**: 外部キー制約による動画と作者の関連管理
- **削除制御**: 作者削除時の動画への影響を考慮（CASCADE削除または削除不可）

## 実装スコープ

- ✅ 作者検索機能
- ✅ 作者詳細表示機能
- ✅ 作者登録機能
- ✅ 作者編集機能
- ✅ 作者削除機能
- ✅ 作者選択モーダル（ビデオ登録時）
- ✅ 作者詳細画面での動画一覧表示

## 参考資料

### 既存実装
- 動画検索画面: `src/renderer/pages/video.search.page.tsx`
- タグ入力コンポーネント: `features/tag/ui/tag.input.component.tsx`
- ナビゲーションシステム: `features/shared/ui/navigation.*`

### 技術ドキュメント
- React Router DOM: https://reactrouter.com/
- Hono: https://hono.dev/

## 実装時の注意点

- 既存の`Author`モデル（`features/author/author.model.ts`）に準拠
- 初期実装は`id`, `name`, `urls`の3フィールドのみで構成
- `urls`フィールドはデータベースではJSON文字列として保存し、アプリケーション層でパース・シリアライズを行う
- 作者と動画の多対多関係を中間テーブル（Videos_Authors）で管理
- ビデオ登録画面との統合については、既存のビデオ登録フローを確認した上で実装
- URLの動的追加・削除機能を持つフォームコンポーネントの実装が必要
- 外部リンクの表示時にアイコンを自動選択する仕組みの検討（例: twitter → 🐦）
